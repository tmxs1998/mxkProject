"use strict";$(function(){var e=location.search.split("=")[1],u="",_=$(".sp_pic"),v=$(".sp_i"),d=$("#sp_info > .container"),m="",g="",f="";$.ajax("http://localhost:3000/prodatas").then(function(a){for(var s=0;s<a.length;s++)if(e==a[s].id){m+='<img src="'+a[s].imgsrc[0]+'"><ul class="clean">';for(var t=0;t<a[s].imgsrc.length;t++)m+=0==t?'<li class="li_act"><img src="'+a[s].imgsrc[t]+'" ></li>':'<li><img src="'+a[s].imgsrc[t]+'" ></li>';m+='</ul><div class="pic_share clean"><span>分享到：</span><i></i><i></i><i></i><i></i><i></i><i></i></div>',g+="<h4>"+a[s].title+'</h4><ul>\n\t\t\t\t\t<li><span class="sp_i_info">吊牌价：</span><span class="sp_i_dp">'+a[s].dp_price+'.00</span></li><li><span class="sp_i_info">销售价：</span><span class="sp_i_xs">'+a[s].xs_price+'.00</span><span class="sp_i_hd">活动价</span><span class="sp_i_pt">('+a[s].discount+")</span><span>立省￥ "+(a[s].dp_price-a[s].xs_price)+'</span></li><li><span class="sp_i_info">运费：</span><span>'+a[s].send+'</span></li><li><span class="cartSub">-</span><input type="text" value="1" id="cartNum"><span class="cartPlus">+</span><input type="button" value="加入购物车" id="cartBtn" /></li></ul>';for(var i=0;i<a[s].info.length;i++)f+='<img src="'+a[s].info[i]+'" >'}_.html(m),v.html(g),d.html(f);var l=$(".cartSub"),c=$(".cartPlus"),n=$("#cartNum"),p=$("#cartBtn");l.click(function(){var a=n.val();--a<1||n.val(a)}),c.click(function(){var a=n.val();a++,n.val(a)}),n.blur(function(){/^[1-9]\d{0,}$/.test(n.val())?u=n.val():n.val(u)}),p.click(function(){var t=JSON.parse(localStorage.getItem("uSuccess")),i="";t?$.ajax("http://localhost:3000/udata/"+t.id).then(function(a){null==a[e]?(i='{"'+e+'":"'+n.val()+'"}',i=JSON.parse(i),$.ajax("http://localhost:3000/udata/"+t.id,{type:"patch",data:i}),location.assign("http://localhost:8080/html/shopcar.html")):$.ajax("http://localhost:3000/udata/"+t.id).then(function(a){console.log(a);var s=+a[e]+ +n.val();i='{"'+e+'":"'+s+'"}',i=JSON.parse(i),$.ajax("http://localhost:3000/udata/"+t.id,{type:"patch",data:i}),location.assign("http://localhost:8080/html/shopcar.html")})}):location.assign("http:localhost:8080/html/login.html")});var o=$(".sp_pic > ul > li"),r=$(".sp_pic > ul > li > img"),h=$(".sp_pic > img");r.mouseover(function(){var a=$(this).attr("src");o.attr("class",""),$(this).parent().attr("class","li_act"),h.attr("src",a)})})});