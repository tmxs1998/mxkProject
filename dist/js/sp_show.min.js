"use strict";$(function(){var o=location.search.split("=")[1],r="",h=$(".sp_pic"),e=$(".sp_i"),u=$("#sp_info > .container"),d="",v="",_="";$.ajax("http://localhost:3000/prodatas").then(function(a){for(var s=0;s<a.length;s++)if(o==a[s].id){d+='<img src="'+a[s].imgsrc[0]+'"><ul class="clean">';for(var t=0;t<a[s].imgsrc.length;t++)d+='<li><img src="'+a[s].imgsrc[t]+'" ></li>';d+='</ul><div class="pic_share clean"><span>分享到：</span><i></i><i></i><i></i><i></i><i></i><i></i></div>',v+="<h4>"+a[s].title+'</h4><ul>\n\t\t\t\t\t<li><span class="sp_i_info">吊牌价：</span><span class="sp_i_dp">'+a[s].dp_price+'.00</span></li><li><span class="sp_i_info">销售价：</span><span class="sp_i_xs">'+a[s].xs_price+'.00</span><span class="sp_i_hd">活动价</span><span class="sp_i_pt">('+a[s].discount+")</span><span>立省￥ "+(a[s].dp_price-a[s].xs_price)+'</span></li><li><span class="sp_i_info">运费：</span><span>'+a[s].send+'</span></li><li><span class="cartSub">-</span><input type="text" value="1" id="cartNum"><span class="cartPlus">+</span><input type="button" value="加入购物车" id="cartBtn" /></li></ul>';for(var l=0;l<a[s].info.length;l++)_+='<img src="'+a[s].info[l]+'" >'}h.html(d),e.html(v),u.html(_);var i=$(".cartSub"),n=$(".cartPlus"),c=$("#cartNum"),p=$("#cartBtn");i.click(function(){var a=c.val();--a<1||c.val(a)}),n.click(function(){var a=c.val();a++,c.val(a)}),c.blur(function(){/^[1-9]\d{0,}$/.test(c.val())?r=c.val():c.val(r)}),p.click(function(){var t=JSON.parse(localStorage.getItem("uSuccess")),l="";t?$.ajax("http://localhost:3000/udata/"+t.id).then(function(a){null==a[o]?(l='{"'+o+'":"'+c.val()+'"}',l=JSON.parse(l),$.ajax("http://localhost:3000/udata/"+t.id,{type:"patch",data:l}),location.assign("http://localhost:8080/html/shopcar.html")):$.ajax("http://localhost:3000/udata/"+t.id).then(function(a){console.log(a);var s=+a[o]+ +c.val();l='{"'+o+'":"'+s+'"}',l=JSON.parse(l),$.ajax("http://localhost:3000/udata/"+t.id,{type:"patch",data:l}),location.assign("http://localhost:8080/html/shopcar.html")})}):location.assign("http:localhost:8080/html/login.html")})})});